  .. image:: https://zenodo.org/badge/DOI/10.5281/zenodo.4686056.svg
   :target: https://doi.org/10.5281/zenodo.4686056

   .. image:: https://img.shields.io/badge/binder-Hapi-F5A252.svg?logo=data:image/png;base64,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
    :target: https://mybinder.org/v2/gh/MAfarrag/HAPI/master


Current release info
====================

.. image:: https://img.shields.io/pypi/v/Hapi-nile
  :target: https://pypi.org/project/HAPI-Nile/1.0.4/


.. image:: https://img.shields.io/conda/v/conda-forge/hapi?label=conda-forge
  :target: https://pypi.org/project/HAPI-Nile/1.0.4/


.. image:: https://img.shields.io/pypi/pyversions/hapi-nile
  :target: https://pypi.org/project/HAPI-Nile/1.0.4/


.. image:: https://img.shields.io/github/forks/mafarrag/hapi?style=social   :alt: GitHub forks


.. image:: https://anaconda.org/conda-forge/hapi/badges/downloads.svg
  :target: https://anaconda.org/conda-forge/hapi


.. image:: https://img.shields.io/conda/vn/conda-forge/hapi   :alt: Conda (channel only)
  :target: https://pypi.org/project/HAPI-Nile/1.0.4/


.. image:: https://img.shields.io/gitter/room/mafarrag/Hapi
  :alt: Gitter


.. image:: https://static.pepy.tech/personalized-badge/hapi-nile?period=total&units=international_system&left_color=grey&right_color=blue&left_text=Downloads
  :target: https://pypi.org/project/HAPI-Nile/1.0.4/


.. image:: https://img.shields.io/pypi/v/hapi-nile
  :alt: PyPI


.. image:: https://anaconda.org/conda-forge/hapi/badges/platforms.svg
  :target: https://anaconda.org/conda-forge/hapi


.. image:: https://static.pepy.tech/personalized-badge/hapi-nile?period=total&units=international_system&left_color=grey&right_color=blue&left_text=Downloads
  :target: https://pepy.tech/project/hapi-nile



.. image:: https://static.pepy.tech/personalized-badge/hapi-nile?period=month&units=international_system&left_color=grey&right_color=blue&left_text=Downloads
  :target: https://pepy.tech/project/hapi-nile


.. image:: https://static.pepy.tech/personalized-badge/hapi-nile?period=week&units=international_system&left_color=grey&right_color=blue&left_text=Downloads
  :target: https://pepy.tech/project/hapi-nile




Hapi - Hydrological library for Python
=====================================================================

  .. image:: /img/Hapi.png
    :width: 400pt
    :align: center


  .. image:: /img/name.png
    :width: 400pt
    :align: center


**Hapi** is a Python package providing fast and flexible way to build Hydrological models with different spatial representations (lumped, semidistributed and conceptual distributed) using HBV96.
The package is very flexible to an extent that it allows developers to change the structure of the defined conceptual model or to enter
their own model, it contains two routing functions muskingum cunge, and MAXBAS triangular function.



.. image:: /img/Picture1.png
  :width: 400pt
  :align: center

  .. image:: /img/Picture2.png
   :width: 800pt
   :align: center

Main Features
-------------
- Modified version of HBV96 hydrological model (Bergström, 1992) with 15 parameters in case of considering
  snow processes, and 10 parameters without snow, in addition to 2 parameters of Muskingum routing method
- Remote sensing module to download the meteorological inputs required for the hydrologic model simulation (ECMWF)
- GIS modules to enable the modeler to fully prepare the meteorological inputs and do all the preprocessing
  needed to build the model (align rasters with the DEM), in addition to various methods to manipulate and
  convert different forms of distributed data (rasters, NetCDF, shapefiles)
- Sensitivity analysis module based on the concept of one-at-a-time OAT and analysis of the interaction among
  model parameters using the Sobol concept ((Rusli et al., 2015)) and a visualization
- Statistical module containing interpolation methods for generating distributed data from gauge data, some
  distribution for frequency analysis and Maximum likelihood method for distribution parameter estimation.
- Visualization module for animating the results of the distributed model, and the meteorological inputs
- Optimization module, for calibrating the model based on the Harmony search method

The recent version of Hapi (Hapi 1.0.1 Farrag et al. (2021)) integrates the global hydrological parameters obtained by Beck et al., (2016), to reduce model complexity and uncertainty of parameters.


For using Hapi please cite Farrag et al. (2021) and Farrag & Corzo (2021) References

IHE-Delft sessions
------------------
- In April 14-15 we had a two days session for Masters and PhD student in IHE-Delft to explain the different modules and the distributed hydrological model in Hapi [Day 1](https://youtu.be/HbmUdN9ehSo) ,  [Day 2](https://youtu.be/m7kHdOFQFIY)

.. digraph:: Linking

    Hapi -> GIS;
    Hapi -> HM;
    Hapi -> RemoteSensing;
    Hapi -> RRM;
    Hapi -> Statistics;
    Hapi -> catchment;
    Hapi -> weirdFn;
    Hapi -> visualizer;
    dpi=400;

.. digraph:: Linking

    RRM -> HBV;
    RRM -> calibration;
    RRM -> distparameters;
    RRM -> distrrm;
    RRM -> routing;
    RRM -> run;
    RRM -> inputs;
    RRM -> wrapper;
    RRM -> hbv_lake;
    RRM -> hbv_bergestrom92;
    dpi=400;

.. digraph:: Linking

    HM -> inputs;
    HM -> event;
    HM -> river;
    HM -> calibration;
    HM -> crosssection;
    HM -> interface;
    dpi=400;

Future work
-------------
- Developing a regionalization method for connection model parameters with some catchment characteristics for better model calibration.
- Developing and integrate river routing method (kinematic and diffusive wave approximation)
- Apply the model for large scale (regional/continental) cases
- Developing a DEM processing module for generating the river network at different DEM spatial resolutions.

References
==========

Farrag, M. & Corzo, G. (2021) MAfarrag/Hapi: Hapi. doi:10.5281/ZENODO.4662170

Farrag, M., Perez, G. C. & Solomatine, D. (2021) Spatio-Temporal Hydrological Model Structure and Parametrization Analysis. J. Mar. Sci. Eng. 9(5), 467. doi:10.3390/jmse9050467

Beck, H. E., Dijk, A. I. J. M. van, Ad de Roo, Diego G. Miralles, T. R. M. & Jaap Schellekens,  and L. A. B. (2016) Global-scale regionalization of hydrologic model parameters-Supporting materials 3599–3622. doi:10.1002/2015WR018247.Received

Bergström, S. (1992) The HBV model - its structure and applications. Smhi Rh 4(4), 35.

Rusli, S. R., Yudianto, D. & Liu, J. tao. (2015) Effects of temporal variability on HBV model calibration. Water Sci. Eng. 8(4), 291–300. Elsevier Ltd. doi:10.1016/j.wse.2015.12.002


.. toctree::
   :hidden:
   :maxdepth: 1

   Installation <Installation.rst>
   Hydrological model <Hydrological model.rst>
   Hydrodynamic model <Hydrodynamic model.rst>
